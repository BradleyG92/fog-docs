This describes how to manually migrate all images to a new server.

Related article: [[FOG_Client#Maintain_Control_Of_Hosts_When_Building_New_Server]]

= Image files =

Below, are many options for migrating all images. This article assumes you have FOG installed already on the new server, because the installer would setup FTP and NFS for you. Fog doesn't setup Samba but an example of how to use a Samba share is included. Where you see x.x.x.x, this is the old storage node's IP address. These commands are written to be run on the new storage node, however they can be altered to run on the old storage node.

== using lftp ==

<pre>lftp -c 'open x.x.x.x; user UserGoesHere PasswordHere; mirror -e /images/TheImagePath /images/TheImagePath; quit'</pre>

Example:

<pre>
lftp -c 'open 10.0.0.4; user fog MyAwesomePassword; mirror -e /images /images; quit'
</pre>


== using NFS ==

<pre>
mount x.x.x.x:/<remote source> <local mount point>
cp -R /<local mount point>/* /<local destination>
umount <local mount point>
</pre>

Example:

<pre>
mkdir /tempMount
mount 10.0.0.4:/images /tempMount
cp -R /tempMount/* /images
umount /tempMount
</pre>

== Using Samba ==

<pre>
mkdir /LocalMountPointHere
mount -t cifs //x.x.x.x/ShareNameGoesHere /LocalMountPointHere -o username=YourUsernameGoesHere -o password=YourPasswordGoesHere,noexec
cp -r /LocalMountPointHere/* /DestinationHere
umount /LocalMountPointHere
</pre>

Example:

<pre>
mkdir /tempMount
mount -t cifs //10.0.0.4/images /tempMount -o username=root -o password=MyAwesomePassword,noexec
cp -r /tempMount/* /images
umount /tempMount
</pre>

== Using SCP ==

<pre>scp -r root@x.x.x.x:/images/* /images</pre>

Example:

<pre>
scp -r root@10.0.0.4:/images/* /images
</pre>


== Using rsync ==

<pre>
rsync -a root@x.x.x.x:/images/* /images
</pre>

Example:

<pre>
rsync -a root@10.0.0.4:/images* /images
</pre>

= Image Definitions =

Image definitions are what's stored in the database, and what is displayed in the web interface. There are DB entries for each image. Image definitions do not automatically appear just because the image files are present on the storage node, this is a common misconception.

You may recreate these manually, but you '''must''' recreate them exactly as they were on the old server. The image path '''must''' be exact and is '''case sensitive''', the image OS and image type '''must''' be set exactly as in the old server as well. 

The easiest option is to use FOG's export/import feature inside of Image Management.